var n=class{constructor(t){this._ratio=0;this._dragStep=0;this._lastPointer=0;this._isDragging=!1;this._resizeTimer=null;this._destroyed=!1;this.track=r(t.track),this.thumb=r(t.thumb),this.viewport=r(t.viewport),this.contentEls=h(t.content),this.direction=t.direction??"horizontal",this.keyboardSteps=t.keyboardSteps??50,this.trackClick=t.trackClick??!0,this.autoResize=t.autoResize??!0,this.resizeDebounce=t.resizeDebounce??100,this.onScrollCb=t.onScroll,this.onDragStartCb=t.onDragStart,this.onDragEndCb=t.onDragEnd,this._onDown=this.handleDown.bind(this),this._onMove=this.handleMove.bind(this),this._onUp=this.handleUp.bind(this),this._onKey=this.handleKey.bind(this),this._onTrackClick=this.handleTrackClick.bind(this),this._onResize=this.handleResize.bind(this),this.init()}get ratio(){return this._ratio}get isDragging(){return this._isDragging}scrollTo(t){this._ratio=t,this.clampAndApply()}scrollToOffset(t){let e=this.viewportSize(),i=this.contentSize(),o=t-e/2;this._ratio=o/(i-e),this.clampAndApply()}update(){this.sizeThumb(),this.applyPosition()}focus(){this.thumb.focus()}destroy(){this._destroyed||(this._destroyed=!0,this.thumb.removeEventListener("mousedown",this._onDown),this.thumb.removeEventListener("touchstart",this._onDown),this.thumb.removeEventListener("keydown",this._onKey),document.removeEventListener("mousemove",this._onMove),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("mouseup",this._onUp),document.removeEventListener("touchend",this._onUp),this.trackClick&&this.track.removeEventListener("click",this._onTrackClick),this.autoResize&&window.removeEventListener("resize",this._onResize),this._resizeTimer!==null&&clearTimeout(this._resizeTimer))}init(){this.thumb.hasAttribute("tabindex")||this.thumb.setAttribute("tabindex","0"),this.thumb.hasAttribute("role")||(this.thumb.setAttribute("role","slider"),this.thumb.setAttribute("aria-valuemin","0"),this.thumb.setAttribute("aria-valuemax","100"),this.thumb.setAttribute("aria-valuenow","0")),this.thumb.hasAttribute("aria-label")||this.thumb.setAttribute("aria-label","Scrollbar"),this.thumb.addEventListener("mousedown",this._onDown),this.thumb.addEventListener("touchstart",this._onDown,{passive:!1}),this.thumb.addEventListener("keydown",this._onKey),this.trackClick&&this.track.addEventListener("click",this._onTrackClick),this.autoResize&&window.addEventListener("resize",this._onResize),this.sizeThumb()}isHorizontal(){return this.direction==="horizontal"}trackSize(){return this.isHorizontal()?this.track.offsetWidth:this.track.offsetHeight}thumbSize(){return this.isHorizontal()?this.thumb.offsetWidth:this.thumb.offsetHeight}viewportSize(){return this.isHorizontal()?this.viewport.offsetWidth:this.viewport.offsetHeight}contentSize(){let t=this.contentEls[0];return this.isHorizontal()?t.scrollWidth:t.scrollHeight}sizeThumb(){let t=this.viewportSize()/this.contentSize(),e=this.trackSize()*Math.min(t,1);this.isHorizontal()?this.thumb.style.width=e+"px":this.thumb.style.height=e+"px",this._dragStep=this.trackSize()/this.keyboardSteps}applyPosition(){let t=this._ratio*(this.trackSize()-this.thumbSize()),e=-this._ratio*(this.contentSize()-this.viewportSize());if(this.isHorizontal()){this.thumb.style.left=t+"px";for(let i of this.contentEls)i.style.left=e+"px"}else{this.thumb.style.top=t+"px";for(let i of this.contentEls)i.style.top=e+"px"}this.thumb.setAttribute("aria-valuenow",String(Math.round(this._ratio*100))),this.onScrollCb?.(this._ratio)}clampAndApply(){this._ratio<0&&(this._ratio=0),this._ratio>1&&(this._ratio=1),this.applyPosition()}handleDown(t){t.preventDefault(),this.thumb.focus(),this._isDragging=!0,this._lastPointer=this.pointerPos(t),document.addEventListener("mousemove",this._onMove),document.addEventListener("touchmove",this._onMove,{passive:!1}),document.addEventListener("mouseup",this._onUp),document.addEventListener("touchend",this._onUp),this.onDragStartCb?.()}handleMove(t){t.preventDefault();let e=this.pointerPos(t),i=this._lastPointer-e;this._lastPointer=e;let o=this.currentThumbPos()-i;this._ratio=o/(this.trackSize()-this.thumbSize()),this.clampAndApply()}handleUp(){this._isDragging=!1,document.removeEventListener("mousemove",this._onMove),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("mouseup",this._onUp),document.removeEventListener("touchend",this._onUp),this.onDragEndCb?.()}handleKey(t){let e=this.isHorizontal()?"ArrowLeft":"ArrowUp",i=this.isHorizontal()?"ArrowRight":"ArrowDown",o=this._dragStep/(this.trackSize()-this.thumbSize());t.key===e?(t.preventDefault(),this._ratio-=o,this.clampAndApply()):t.key===i?(t.preventDefault(),this._ratio+=o,this.clampAndApply()):t.key==="Home"?(t.preventDefault(),this._ratio=0,this.clampAndApply()):t.key==="End"&&(t.preventDefault(),this._ratio=1,this.clampAndApply())}handleTrackClick(t){if(t.target===this.thumb||this.thumb.contains(t.target))return;let e=this.track.getBoundingClientRect(),i=this.isHorizontal()?t.clientX-e.left:t.clientY-e.top;this._ratio=i/this.trackSize(),this.clampAndApply()}handleResize(){this._resizeTimer!==null&&clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(()=>{this.sizeThumb(),this.applyPosition()},this.resizeDebounce)}pointerPos(t){if("clientX"in t)return this.isHorizontal()?t.clientX:t.clientY;let e=t.touches[0];return this.isHorizontal()?e.clientX:e.clientY}currentThumbPos(){return this.isHorizontal()?this.thumb.offsetLeft:this.thumb.offsetTop}};function r(s){if(typeof s=="string"){let t=document.querySelector(s);if(!t)throw new Error(`DetachedScrollbar: element not found for selector "${s}"`);return t}return s}function h(s){return(Array.isArray(s)?s:[s]).map(r)}export{n as DetachedScrollbar};
//# sourceMappingURL=index.js.map